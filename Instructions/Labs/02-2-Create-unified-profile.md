---
lab:
  title: 'ラボ 2.2: 統合顧客プロファイルの作成'
---

# ラボ 2.2: 統合顧客プロファイルの作成

## ラーニング パス 2: Dynamics 365 Customer Insights - Data で統合顧客プロファイルを操作する

データ ソースからの生データをエンティティに取り込んで、マップ、照合、結合プロセスを開始し、各顧客プロファイル ソースのデータを結合することで、1 つの統合顧客プロファイルを作成します。 これを行うには、まず、取り込んだエンティティを標準モデルに対してマップした後、プロファイルされた各エンティティに対して主キーを選択します。 この処理が完了したら、すべての顧客エンティティの連絡先との照合に使用される照合ルールを作成します。 最後に、結合プロセスを実行すると、照合ルールを使用して、一意の顧客を含む 1 つのセットが作成されます。これらの顧客プロファイルは、すべての顧客エンティティで一致しています。 ここでの目的は、Contoso Retail が保持しているさまざまなデータ ソース間の一意の顧客プロファイルの数を確認することです。

## 演習 1 - データを統合する

### タスク 1 - 連絡先を共通のデータ型にマップする
1. https://home.ci.ai.dynamics.com で Customer Insights - Data にサインインします。
2. 左側のナビゲーション メニューで、**[データ]** を展開して、**[統合]** を選択します。
3. [顧客データ] セクションで、**[開始する]** を選択します。
4. **[統合する顧客データを説明する]** 画面で、**[+ 開始する]** を選択します。
5. 顧客プロファイルを表すテーブルを選択します。 表は次のとおりです。
   - 連絡先 (eコマース)
   - 顧客 (ロイヤルティ)
6. **適用**を選択します。
7. 次に、標準モデル タイプに対するソース テーブルのマッピングが表示されます。 テーブル内のタイプを確認できます。
8. 取り込んだ各エンティティの「主キー」を選択する必要があります。 主キーは、一意の参照である必要があります。 eCommerceContacts については、**ContactId** を主キーとして選択します。
9. eコマース連絡先のデータには、**Email Subscriber** という名前の列が含まれています。この列は、その名前のために正しくない型 (Identity.Service.Email) にマップされます。 この列のドロップダウンを開き、空のオプション (nothing/blank) を選択します。 これを行わない場合、システムの既定の動作では、このフィールドを電子メールのフィールドに結合します。
10. テーブルの下の **Loyalty Customers** を選択し、**LoyaltyId** を主キーとして設定します。
11. 左上隅の **[ソース列を保存]** を選択します。
12. **[次へ]** ボタンを選択し、もう一度 **[次へ]** を選択して重複のチェックをスキップし、照合ルールのステップに進みます。

### タスク 2 - 一致順序を指定する
次のステージでは、プロファイルを結合する順序を選択する必要があります。 属性を結合して、統合プロファイルを完成し、それらの属性に使用するソースの優先順位が設定されるようにします。
1. プライマリ (最初の) ソースとして、最も完全または正確なプロファイル ソースを選択する必要があります。 **Contacts: eCommerce** がプライマリ (最初の) ソースであることを確認します (または、まだ移動していない場合は移動します)。
2. **すべてのレコードを含める**には、チェック・マークをオンにします。
3. **Customers: Loyalty** がリストの 2 番目のソースであることを確認します。 選択して、**すべてのレコードを含めます**。

### タスク 3 - 照合ルールを作成する
このタスクでは、レコードの照合に使用する簡易ルールを作成します。 ルールは、単一の条件 (例: ID に基づく) または複数の条件 (例: フルネーム、郵便番号、生年月日) で構成することができます。 照合ルールの詳細については、Customer Insights のドキュメントを参照してください。
1. **Customers: Loyalty line** に警告インジケーターがあります。 **[+ ルールの追加]** を選択するか、右側の **+** アイコンを選択します。
2. FullName を使用して最初の条件を追加します。
   - Contacts: eCommerce テーブルで、**FullName** フィールドを選択します。
   - Customers: Loyalty テーブルで、**FullName** フィールドを選択します。
   - 正規化のドロップダウンは空白のままにします。
   - ドロップダウン フィールドを使用して、精度レベルを **[Basic]** に設定します。
   - スライダーを使用して、精度の値を **[高]** に設定します。
3. ルールに **FullName, Email** という名前を入力します。
4. **[+ 追加]** を選択し、**[条件の追加]** を選択して、メール アドレスの 2 つめの条件を追加します。
   - Contacts: eCommerce テーブルで、**EMail** フィールドを選択します。
   - Customers: Loyalty テーブルで、**EMail** フィールドを選択します。
   - 正規化のドロップダウンは空白のままにします。
   - 精度レベルを **[Basic]** に設定します。
   - 精度の値を **[高]** に設定します。
5. **完了** を選択します。
6. **[次へ]** を選択し、**[次へ]** を選択して、**[顧客プロファイルの作成]** を選択します。

Customer Insights によって、顧客情報のすべてのソースからの顧客データが照合され、ルールに基づいて固有の顧客プロファイルの数が特定されます。 クラスで話し合う: データセットを組み合わせると、一意の顧客の数はいくつですか

### タスク 4 - 精度
タスク 3 では、フル ネームに対する照合ルールで [高] 精度を使用しました。 このタスクでは、精度レベルを調整して、信頼度の低い一致を含めることで、より多くの一致を作成します (結果として、一意のプロファイルの数が少なくなります)。

**精度に関する注意事項:**
- スケールの右側の正確なレコードは、条件に完全に一致するレコードと一致します。 別のレベルのいずれかを選択して、100% 同じではないレコードと一致するようにします。
- [高] は、特定の顧客に対する金融サービスなど、リーチよりも精度が重要な場合に適しています。
- [低] は、マーケティング キャンペーンなど、[高] の逆が当てはまる場合に適しています。
- 中間のレベルは、中間点の選択肢として機能します。

1. Customer Insights で、左側のナビゲーション メニューの **[データ]** を展開します。 **[統合]** を選択します。
2. [照合ルール] で **[編集]** を選択します。
3. **Customers: Loyalty** ルールを展開し、**[編集]** ボタンを選択して、**FullName, Emaill** の条件ウィンドウを開きます。
4. 条件 1 で、**[プレビュー]** を選択し、値をメモします。 条件 1 の精度スライダーを **[高]** から **[低]** に移動します。 **完了** を選択します。
5. **[次へ]** を選択し、**[次へ]** を選択して、**[顧客プロファイルの作成]** を選択します。
6. 照合プロセスが完了するまで待ちます。
7. 照合プロセスが完了したら、照合ルールで **[編集]** をクリックします。 **FullName, Email** ルールの横にある**縦に並んだドット メニュー**を選択し、**[プレビュー]** を選択して照合結果とスコアを表示します。 これにより、Customer Insights が、定義したルールに基づいてデータ テーブルとどのように照合したのかが示されます。 一部のプロファイルは、照合の信頼性が低い状態で作成されています。
8. プレビューを閉じて、[編集] を選択します。 条件 1 の下にある [プレビュー] ボタンを選択します。 ここでは、FullName 条件の不一致レコードと一致レコードの数をプレビューできます。
9. [不一致] または [一致] の下で **[データのプレビュー]** を選択して、一致をプレビューします。 スコアの高い一致結果のスペルは正確ですが、名前の形式 (First Name, Last Name / Last Name, First Name) が異なる場合でも一致する可能性があることに注意してください。 スコアが低い場合は、名前のスペルが同じでない場合でも、一致が行われていることがわかります。
10. 条件のプレビュー ウィンドウを閉じ、**[キャンセル]** を選択します。

クラスで話し合う: 現在保有している一意の顧客プロファイルの数はいくつですか?

### タスク 5 - 顧客フィールドを統合する
これは、データ統合プロセスの最後のフェーズです。 その目的は、競合するデータを調整し、統合顧客プロファイルで使用される属性を定義することです。 結合された属性とは、複数のデータ ソースに存在し、同じデータを表す属性です。 たとえば、eコマースの顧客とロイヤルティの顧客の両方のデータソースに「メール アドレス」が存在する場合があります。 Customer Insights では、ソース フィールドのステップで定義した標準データ型に結合される属性の特定を試みます。

1. Customer Insights で、左側のナビゲーション メニューの **[データ]** を展開します。 **[統合]** を選択します。
2. [統合データ] ビューで、**[編集]** を選択します。
3. [顧客] 列の下で、同じ型 (FirstName など) の異なるデータ ソースの属性がどのように結合されているかに注意してください。
4. 結合された **FirstName** 属性を展開します。 eCommerce: Contacts の FirstName 属性が 番号 1 にランク付けされていることがわかります。 これは、LoyaltyScheme と eCommerce の顧客プロファイルが一致している場合に、eCommerce: Contacts から取得された FirstName がプライマリとなることを示しています。
9. **[次へ]** を選択し、**[顧客プロファイルの作成]** を選択します。
10. プロセスが完了するまで待ちます。

お疲れさまでした。 Customer Insights 内の複数ソースのデータの取り込み、マップ、照合、統合を行い、顧客ベース全体のインサイト取得に使用できる、統合顧客プロファイルを作成することができました。

## 演習 2 - 顧客を検索する
この演習では、Customer Insights ユーザーが統合された顧客プロファイルを検索できるように、検索条件とフィルター条件を設定して、特定の顧客または顧客グループに関する情報をすばやく取得できるようにします。

### タスク 1 - 検索列とフィルター インデックスを構成する
1. Customer Insights で、左側のナビゲーション メニューから **[顧客]** を選択します。
2. **[検索とフィルター インデックス]** を選択します。
3. 一部の顧客検索固有のフィールドは既定で既に追加されており、ツール バーから **[+ 追加]** を選択することで、さらに追加できます。
4. **CustomerId、FirstName、LastName、FullName、DateOfBirth、EMail、PostCode、ContactId (eCommerce_Contacts)** および **LoyaltyId** が選択されていることを確認します。 チェックされているその他のフィールドの選択を解除します。 **適用**を選択します。
5. **[保存]** を選択します。

### タスク 2 - 顧客レコードを検索する
1. Customer Insights で、左側のナビゲーション メニューから **[顧客]** を選択します。 統合プロファイルを表す一連の顧客カードが表示されます。 カードを展開して顧客に関する詳細を表示したり、さまざまなフィールドでカードを並べ替えたりすることができます。 ツール バーの **[カードの展開]** と **[並べ替え]** を選択して、これを試してみてください。
2. 顧客の検索を使用して、統合された顧客プロファイルに関連するテキスト属性を検索できます。 (例: 「24502」を検索すると、すべてのテキスト属性が検索され、一致と部分一致が返されます)。

検索バーを使用して、次の質問に答えます。
- Brian Gobble の生年月日は? (Brian Gobble を検索)
- ロイヤルティ カード ID LOYID_5707 を保有しているのはどの顧客か? (LOYID_5707 を検索)
- 郵便番号が 24502 の顧客はどれか? (24502 を検索)
